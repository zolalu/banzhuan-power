<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¿ç –çš„åšå®¢ - AIäº§å“æ€è€ƒ</title>
    <link rel="stylesheet" href="https://cdn.staticfile.org/tailwindcss/2.2.19/tailwind.min.css">
    <link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;500;600;700&family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        :root {
            --color-primary: #2563eb;
            --color-secondary: #7c3aed;
            --color-accent: #f59e0b;
            --color-text: #1f2937;
            --color-text-light: #6b7280;
            --color-bg: #ffffff;
            --color-bg-secondary: #f9fafb;
            --color-border: #e5e7eb;
            --color-highlight: #fef3c7;
            --color-highlight-border: #f59e0b;
        }

        .dark {
            --color-text: #f9fafb;
            --color-text-light: #d1d5db;
            --color-bg: #111827;
            --color-bg-secondary: #1f2937;
            --color-border: #374151;
            --color-highlight: #451a03;
            --color-highlight-border: #f59e0b;
        }

        body {
            font-family: 'Noto Sans SC', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: var(--color-bg);
            color: var(--color-text);
            line-height: 1.7;
        }

        .blog-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }

        .article-card {
            background: var(--color-bg);
            border: 1px solid var(--color-border);
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.3s ease;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            position: relative;
        }

        .article-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .article-card:hover .card-actions {
            opacity: 1;
        }

        .card-actions {
            position: absolute;
            top: 0.75rem;
            right: 0.75rem;
            display: flex;
            gap: 0.5rem;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .card-action-btn {
            width: 32px;
            height: 32px;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.875rem;
            transition: all 0.2s ease;
            backdrop-filter: blur(8px);
        }

        .edit-btn {
            background: rgba(59, 130, 246, 0.9);
            color: white;
        }

        .edit-btn:hover {
            background: rgba(59, 130, 246, 1);
            transform: scale(1.1);
        }

        .delete-btn {
            background: rgba(239, 68, 68, 0.9);
            color: white;
        }

        .delete-btn:hover {
            background: rgba(239, 68, 68, 1);
            transform: scale(1.1);
        }

        .article-content {
            max-width: 800px;
            margin: 0 auto;
            font-size: 1.125rem;
            line-height: 1.8;
        }

        .article-content h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin: 2rem 0 1rem 0;
            color: var(--color-text);
            font-family: 'Noto Serif SC', serif;
        }

        .article-content h2 {
            font-size: 2rem;
            font-weight: 600;
            margin: 2rem 0 1rem 0;
            color: var(--color-text);
            font-family: 'Noto Serif SC', serif;
            border-bottom: 2px solid var(--color-primary);
            padding-bottom: 0.5rem;
        }

        .article-content h3 {
            font-size: 1.5rem;
            font-weight: 600;
            margin: 1.5rem 0 0.75rem 0;
            color: var(--color-text);
        }

        .article-content h4 {
            font-size: 1.25rem;
            font-weight: 600;
            margin: 1.25rem 0 0.5rem 0;
            color: var(--color-text);
            border-bottom: 1px solid var(--color-border);
            padding-bottom: 0.25rem;
        }

        .article-content h5 {
            font-size: 1.125rem;
            font-weight: 600;
            margin: 1rem 0 0.5rem 0;
            color: var(--color-primary);
        }

        .article-content h6 {
            font-size: 1rem;
            font-weight: 600;
            margin: 1rem 0 0.5rem 0;
            color: var(--color-text-light);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .article-content p {
            margin: 1.25rem 0;
            color: var(--color-text);
        }

        .article-content a {
            color: var(--color-primary);
            text-decoration: none;
            border-bottom: 1px solid transparent;
            transition: all 0.2s ease;
        }

        .article-content a:hover {
            border-bottom-color: var(--color-primary);
        }

        .article-content img {
            max-width: 100%;
            height: auto;
            margin: 2rem auto;
            display: block;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .article-content video {
            max-width: 100%;
            height: auto;
            margin: 2rem auto;
            display: block;
            border-radius: 8px;
        }

        .article-content blockquote {
            border-left: 4px solid var(--color-primary);
            padding: 1rem 1.5rem;
            margin: 2rem 0;
            background: var(--color-bg-secondary);
            border-radius: 0 8px 8px 0;
            font-style: italic;
        }

        .article-content code {
            background: var(--color-bg-secondary);
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.9em;
        }

        .article-content pre {
            background: var(--color-bg-secondary);
            padding: 1.5rem;
            border-radius: 8px;
            overflow-x: auto;
            margin: 1.5rem 0;
            white-space: pre;
            tab-size: 4;
        }

        .article-content pre code {
            background: none;
            padding: 0;
            border-radius: 0;
            font-size: inherit;
        }

        .article-content ul, .article-content ol {
            margin: 1.25rem 0;
            padding-left: 2rem;
        }

        .article-content li {
            margin: 0.5rem 0;
        }

        .article-content ol {
            list-style-type: decimal;
        }

        .article-content ul {
            list-style-type: disc;
        }

        .article-content ol li {
            padding-left: 0.5rem;
        }

        .article-content ul li {
            padding-left: 0.5rem;
        }

        .highlight {
            background: #f0fdf4;
            padding: 1.25rem 1.5rem;
            margin: 1.5rem 0;
            border-radius: 8px;
            position: relative;
            border-left: 3px solid #22c55e;
            font-weight: 500;
            font-size: 1.05em;
            line-height: 1.6;
            color: #166534;
        }

        .highlight::before {
            content: "ğŸ’¡";
            position: absolute;
            left: 0.75rem;
            top: 0.75rem;
            font-size: 1.2rem;
        }

        .dark .highlight {
            background: #0f1f13;
            border-left-color: #16a34a;
            color: #bbf7d0;
        }

        .editor-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            height: 70vh;
        }

        .editor-textarea {
            width: 100%;
            height: 100%;
            padding: 1rem;
            border: 1px solid var(--color-border);
            border-radius: 8px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 14px;
            resize: none;
            background: var(--color-bg);
            color: var(--color-text);
            white-space: pre-wrap;
            tab-size: 4;
            line-height: 1.6;
            overflow-wrap: break-word;
        }

        .preview-container {
            border: 1px solid var(--color-border);
            border-radius: 8px;
            padding: 1rem;
            overflow-y: auto;
            background: var(--color-bg);
            white-space: pre-wrap;
            tab-size: 4;
        }

        .toolbar {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .toolbar button {
            padding: 0.5rem 1rem;
            border: 1px solid var(--color-border);
            border-radius: 6px;
            background: var(--color-bg);
            color: var(--color-text);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .toolbar button:hover {
            background: var(--color-bg-secondary);
            border-color: var(--color-primary);
        }

        .add-button {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--color-primary), var(--color-secondary));
            color: white;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .add-button:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
        }

        .tag {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            background: var(--color-bg-secondary);
            color: var(--color-primary);
            border-radius: 20px;
            font-size: 0.875rem;
            margin: 0.25rem;
        }

        .back-button {
            position: fixed;
            top: 2rem;
            left: 2rem;
            padding: 0.75rem 1.5rem;
            background: var(--color-bg);
            border: 1px solid var(--color-border);
            border-radius: 8px;
            color: var(--color-text);
            text-decoration: none;
            transition: all 0.2s ease;
            z-index: 100;
        }

        .back-button:hover {
            background: var(--color-bg-secondary);
            transform: translateX(-2px);
        }

        .nav-button {
            display: flex;
            align-items: center;
            padding: 1rem 1.5rem;
            background: var(--color-bg-secondary);
            border: 1px solid var(--color-border);
            border-radius: 12px;
            color: var(--color-text);
            text-decoration: none;
            transition: all 0.3s ease;
            cursor: pointer;
            max-width: 300px;
        }

        .nav-button:hover {
            background: var(--color-bg);
            border-color: var(--color-primary);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .nav-label {
            font-size: 0.875rem;
            color: var(--color-text-light);
            font-weight: 500;
            margin-bottom: 0.25rem;
        }

        .nav-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--color-text);
            line-height: 1.4;
        }

        .prev-button {
            margin-right: auto;
        }

        .next-button {
            margin-left: auto;
        }

        @media (max-width: 768px) {
            .editor-container {
                grid-template-columns: 1fr;
                height: auto;
            }
            
            .article-content h1 {
                font-size: 2rem;
            }
            
            .article-content h2 {
                font-size: 1.5rem;
            }

            .article-content h3 {
                font-size: 1.25rem;
            }

            .article-content h4 {
                font-size: 1.125rem;
            }

            .article-content h5 {
                font-size: 1rem;
            }

            .article-content h6 {
                font-size: 0.875rem;
            }

            .nav-button {
                max-width: 200px;
                padding: 0.75rem 1rem;
            }

            .nav-title {
                font-size: 0.875rem;
                line-height: 1.3;
            }

            .nav-label {
                font-size: 0.75rem;
            }

            .article-navigation {
                margin-top: 2rem;
                padding-top: 1.5rem;
            }

            .highlight {
                padding: 1rem 1.5rem;
                margin: 1.5rem 0;
            }

            .highlight::before {
                left: -12px;
                padding: 0.375rem;
                font-size: 1.25rem;
            }
        }
    </style>
</head>
<body>
    <a href="index.html" class="back-button" id="back-button">
        <i class="fas fa-arrow-left mr-2"></i><span id="back-text">è¿”å›ä¸»é¡µ</span>
    </a>

    <div class="blog-container">
        <!-- åšå®¢åˆ—è¡¨é¡µé¢ -->
        <div id="blog-list" class="page">
            <header class="text-center mb-12">
                <h1 class="text-4xl md:text-6xl font-bold mb-4">
                    <span class="bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent">æ¿ç –çš„åšå®¢</span>
                </h1>
                <p class="text-xl text-gray-600 dark:text-gray-400">åˆ†äº«AIäº§å“æ€è€ƒä¸å®è·µç»éªŒ</p>
            </header>

            <div id="articles-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- æ–‡ç« å¡ç‰‡å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>

        <!-- æ–‡ç« é˜…è¯»é¡µé¢ -->
        <div id="article-view" class="page" style="display: none;">
            <article class="article-content">
                <div id="article-content-display"></div>
                
                <!-- æ–‡ç« å¯¼èˆª -->
                <div class="article-navigation mt-12 pt-8 border-t border-gray-200 dark:border-gray-700">
                    <div class="flex justify-between items-center">
                        <button id="prev-article" class="nav-button prev-button" style="display: none;">
                            <i class="fas fa-arrow-left mr-2"></i>
                            <div>
                                <div class="nav-label">Previous</div>
                                <div class="nav-title"></div>
                            </div>
                        </button>
                        
                        <div class="flex-1"></div>
                        
                        <button id="next-article" class="nav-button next-button" style="display: none;">
                            <div class="text-right">
                                <div class="nav-label">Next</div>
                                <div class="nav-title"></div>
                            </div>
                            <i class="fas fa-arrow-right ml-2"></i>
                        </button>
                    </div>
                </div>
            </article>
        </div>

        <!-- æ–‡ç« ç¼–è¾‘é¡µé¢ -->
        <div id="article-editor" class="page" style="display: none;">
            <div class="mb-6">
                <input type="text" id="article-title" placeholder="æ–‡ç« æ ‡é¢˜" 
                       class="w-full p-3 text-2xl font-bold border border-gray-300 rounded-lg mb-4">
                <input type="text" id="article-tags" placeholder="æ ‡ç­¾ï¼ˆç”¨é€—å·åˆ†éš”ï¼‰" 
                       class="w-full p-2 border border-gray-300 rounded-lg mb-4">
                <input type="file" id="cover-image" accept="image/*" 
                       class="mb-4">
            </div>

            <div class="toolbar">
                <button onclick="insertMarkdown('**', '**')" title="ç²—ä½“">
                    <i class="fas fa-bold"></i>
                </button>
                <button onclick="insertMarkdown('*', '*')" title="æ–œä½“">
                    <i class="fas fa-italic"></i>
                </button>
                <button onclick="insertMarkdown('## ', '')" title="æ ‡é¢˜">
                    <i class="fas fa-heading"></i>
                </button>
                <button onclick="showHeadingMenu()" title="æ›´å¤šæ ‡é¢˜" class="heading-menu-btn">
                    <i class="fas fa-chevron-down"></i>
                </button>
                <button onclick="insertMarkdown('> ', '')" title="å¼•ç”¨">
                    <i class="fas fa-quote-left"></i>
                </button>
                <button onclick="insertMarkdown('`', '`')" title="è¡Œå†…ä»£ç ">
                    <i class="fas fa-code"></i>
                </button>
                <button onclick="insertCodeBlock()" title="ä»£ç å—">
                    <i class="fas fa-file-code"></i>
                </button>
                <button onclick="insertMarkdown('- ', '')" title="æ— åºåˆ—è¡¨">
                    <i class="fas fa-list"></i>
                </button>
                <button onclick="insertMarkdown('1. ', '')" title="æœ‰åºåˆ—è¡¨">
                    <i class="fas fa-list-ol"></i>
                </button>
                <button onclick="insertHighlight()" title="é«˜äº®">
                    <i class="fas fa-highlighter"></i>
                </button>
                <button onclick="document.getElementById('image-upload').click()" title="ä¸Šä¼ å›¾ç‰‡">
                    <i class="fas fa-image"></i>
                </button>
                <button onclick="showImageGallery()" title="å›¾ç‰‡åº“">
                    <i class="fas fa-images"></i>
                </button>
                <button onclick="document.getElementById('video-upload').click()" title="ä¸Šä¼ è§†é¢‘">
                    <i class="fas fa-video"></i>
                </button>
                <input type="file" id="image-upload" accept="image/*" style="display: none;" onchange="handleImageUpload(event)">
                <input type="file" id="video-upload" accept="video/*" style="display: none;" onchange="handleVideoUpload(event)">
            </div>

            <div class="editor-container">
                <textarea id="markdown-editor" class="editor-textarea" placeholder="åœ¨è¿™é‡Œå†™ä¸‹ä½ çš„æƒ³æ³•..."></textarea>
                <div id="preview" class="preview-container article-content"></div>
            </div>

            <div class="mt-4 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg text-sm text-gray-600 dark:text-gray-400">
                <div class="mb-2"><strong>ç¼–è¾‘æç¤ºï¼š</strong></div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-2">
                    <div>â€¢ é«˜äº®æ–‡æœ¬ï¼š==é‡è¦å†…å®¹==</div>
                    <div>â€¢ å›¾ç‰‡å¼•ç”¨ï¼š![æè¿°](å›¾ç‰‡åç§°)</div>
                    <div>â€¢ ç²—ä½“ï¼š**æ–‡æœ¬** æˆ– Ctrl+B</div>
                    <div>â€¢ æ–œä½“ï¼š*æ–‡æœ¬* æˆ– Ctrl+I</div>
                    <div>â€¢ æ— åºåˆ—è¡¨ï¼š- åˆ—è¡¨é¡¹</div>
                    <div>â€¢ æœ‰åºåˆ—è¡¨ï¼š1. åˆ—è¡¨é¡¹</div>
                    <div>â€¢ æ ‡é¢˜ï¼š# ## ### #### ######</div>
                    <div>â€¢ å¼•ç”¨ï¼š> å¼•ç”¨å†…å®¹</div>
                    <div>â€¢ ç¼©è¿›ï¼šTabé”®å¢åŠ ï¼ŒShift+Tabå‡å°‘</div>
                    <div>â€¢ ä»£ç å—ï¼š```è¯­è¨€åç§°</div>
                </div>
                <div class="mt-2 text-xs">
                    æ”¯æŒTabé”®ç¼©è¿›ã€è‡ªåŠ¨åˆ—è¡¨ç»­è¡Œã€ç©ºè¡Œä¿ç•™ã€‚ä¸Šä¼ çš„å›¾ç‰‡å’Œè§†é¢‘ä¼šè‡ªåŠ¨ç”Ÿæˆç®€æ´çš„å¼•ç”¨æ ¼å¼ã€‚
                </div>
            </div>

            <div class="mt-6 flex gap-4">
                <button onclick="saveArticle()" class="px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                    <i class="fas fa-save mr-2"></i>ä¿å­˜æ–‡ç« 
                </button>
                <button onclick="showBlogList()" class="px-6 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors">
                    <i class="fas fa-times mr-2"></i>å–æ¶ˆ
                </button>
            </div>
        </div>
    </div>

    <!-- æ·»åŠ æ–‡ç« æŒ‰é’® -->
    <button class="add-button" onclick="showEditor()" title="å†™æ–°æ–‡ç« ">
        <i class="fas fa-plus"></i>
    </button>

    <script>
        // å…¨å±€å˜é‡
        let articles = JSON.parse(localStorage.getItem('blog_articles') || '[]');
        let currentEditingId = null;

        // å¦‚æœæ²¡æœ‰æ–‡ç« ï¼Œæ·»åŠ ä¸€äº›ç¤ºä¾‹æ–‡ç« 
        if (articles.length === 0) {
            articles = [
                {
                    id: 'sample1',
                title: 'AIäº§å“çš„"äººæœºååŒ"è®¾è®¡æ–¹æ³•è®º',
                content: `# AIäº§å“çš„"äººæœºååŒ"è®¾è®¡æ–¹æ³•è®º

åœ¨AIäº§å“è®¾è®¡ä¸­ï¼Œ"äººæœºååŒ"æ˜¯æ ¸å¿ƒç†å¿µã€‚æœ¬æ–‡æ¢è®¨å¦‚ä½•åœ¨äº§å“ä¸­å¹³è¡¡AIèƒ½åŠ›ä¸äººç±»å¹²é¢„ï¼Œé€šè¿‡åˆç†çš„äº¤äº’è®¾è®¡å’Œåé¦ˆæœºåˆ¶ï¼Œæ‰“é€ æ—¢æ™ºèƒ½åˆå¯æ§çš„äº§å“ä½“éªŒã€‚

## ä»€ä¹ˆæ˜¯äººæœºååŒï¼Ÿ

==äººæœºååŒä¸æ˜¯ç®€å•çš„AIè‡ªåŠ¨åŒ–ï¼Œè€Œæ˜¯è®©AIå’Œäººç±»å„è‡ªå‘æŒ¥ä¼˜åŠ¿ï¼Œå½¢æˆäº’è¡¥çš„å·¥ä½œæ¨¡å¼ã€‚==

åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼š
- **AIè´Ÿè´£**ï¼šæ•°æ®å¤„ç†ã€æ¨¡å¼è¯†åˆ«ã€é‡å¤æ€§ä»»åŠ¡
- **äººç±»è´Ÿè´£**ï¼šåˆ›æ„å†³ç­–ã€å¼‚å¸¸å¤„ç†ã€ä»·å€¼åˆ¤æ–­

## è®¾è®¡åŸåˆ™

### 1. é€æ˜åº¦åŸåˆ™

ç”¨æˆ·éœ€è¦äº†è§£AIåœ¨åšä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆè¿™æ ·åšã€‚

### 2. å¯æ§æ€§åŸåˆ™

==ç”¨æˆ·åº”è¯¥èƒ½å¤Ÿéšæ—¶ä»‹å…¥å’Œä¿®æ­£AIçš„è¡Œä¸ºã€‚==

### 3. æ¸è¿›å¼ä¿¡ä»»

ä»ç®€å•ä»»åŠ¡å¼€å§‹ï¼Œé€æ­¥å»ºç«‹ç”¨æˆ·å¯¹AIçš„ä¿¡ä»»ã€‚

## æ€»ç»“

==è®°ä½ï¼šæœ€å¥½çš„AIäº§å“æ˜¯è®©ç”¨æˆ·æ„Ÿè§‰æ›´èªæ˜ï¼Œè€Œä¸æ˜¯è¢«æ›¿ä»£ã€‚==`,
                tags: 'AIäº§å“,è®¾è®¡æ–¹æ³•è®º,äººæœºååŒ',
                coverImage: 'https://images.unsplash.com/photo-1591696331111-ef9586a5b17a?w=800&h=400&fit=crop',
                date: '2024-05-20T10:00:00.000Z',
                lastModified: '2024-05-20T10:00:00.000Z'
            },
            {
                id: 'sample2',
                title: '2024å¹´AI Agentå‘å±•è¶‹åŠ¿ï¼šä»ç†å¿µåˆ°è½åœ°',
                content: `# 2024å¹´AI Agentå‘å±•è¶‹åŠ¿ï¼šä»ç†å¿µåˆ°è½åœ°

AI Agentæ˜¯ç»§å¯¹è¯å¼AIä¹‹åçš„ä¸‹ä¸€ä¸ªé‡è¦èµ›é“ã€‚æœ¬æ–‡åˆ†æäº†å½“å‰AI Agentçš„å‘å±•ç°çŠ¶ã€æ ¸å¿ƒæŠ€æœ¯æŒ‘æˆ˜å’Œå•†ä¸šåŒ–è·¯å¾„ã€‚

## ä»€ä¹ˆæ˜¯AI Agentï¼Ÿ

==AI Agentæ˜¯èƒ½å¤Ÿè‡ªä¸»æ„ŸçŸ¥ç¯å¢ƒã€åˆ¶å®šè®¡åˆ’å¹¶æ‰§è¡Œè¡ŒåŠ¨çš„æ™ºèƒ½ç³»ç»Ÿã€‚==

ä¸ä¼ ç»Ÿçš„å¯¹è¯å¼AIä¸åŒï¼ŒAgentå…·å¤‡ï¼š
- **è‡ªä¸»æ€§**ï¼šèƒ½å¤Ÿç‹¬ç«‹å®Œæˆå¤æ‚ä»»åŠ¡
- **è§„åˆ’èƒ½åŠ›**ï¼šå¯ä»¥åˆ†è§£ç›®æ ‡ï¼Œåˆ¶å®šæ‰§è¡Œæ­¥éª¤
- **å·¥å…·ä½¿ç”¨**ï¼šèƒ½å¤Ÿè°ƒç”¨å¤–éƒ¨APIå’ŒæœåŠ¡
- **è®°å¿†æœºåˆ¶**ï¼šå…·å¤‡ä¸Šä¸‹æ–‡ç†è§£å’Œå†å²è®°å¿†

## æŠ€æœ¯æŒ‘æˆ˜

### 1. å¯é æ€§é—®é¢˜

==å½“å‰AI Agentåœ¨å¤æ‚ä»»åŠ¡ä¸­çš„æˆåŠŸç‡ä»ç„¶ä¸å¤Ÿç¨³å®šã€‚==

### 2. æˆæœ¬æ§åˆ¶

å¤šè½®å¯¹è¯å’Œå·¥å…·è°ƒç”¨å¸¦æ¥çš„æˆæœ¬å‹åŠ›ã€‚

## æœªæ¥å±•æœ›

==AI Agentå°†æˆä¸ºä¸‹ä¸€ä»£äººæœºäº¤äº’çš„ä¸»è¦å½¢å¼ï¼Œä½†éœ€è¦åœ¨èƒ½åŠ›å’Œå®‰å…¨æ€§ä¹‹é—´æ‰¾åˆ°å¹³è¡¡ã€‚==`,
                tags: 'AI Agent,è¡Œä¸šè¶‹åŠ¿,æŠ€æœ¯åˆ†æ',
                coverImage: 'https://images.unsplash.com/photo-1620712943543-bcc4688e7485?w=800&h=400&fit=crop',
                date: '2024-04-15T14:30:00.000Z',
                lastModified: '2024-04-15T14:30:00.000Z'
            },
            {
                id: 'sample3',
                title: 'æ–‡ç§‘èƒŒæ™¯çš„AIäº§å“ç»ç†å¦‚ä½•é«˜æ•ˆåä½œæŠ€æœ¯å›¢é˜Ÿ',
                content: `# æ–‡ç§‘èƒŒæ™¯çš„AIäº§å“ç»ç†å¦‚ä½•é«˜æ•ˆåä½œæŠ€æœ¯å›¢é˜Ÿ

ä½œä¸ºéæŠ€æœ¯èƒŒæ™¯çš„AIäº§å“ç»ç†ï¼Œå¦‚ä½•æœ‰æ•ˆæ²Ÿé€šéœ€æ±‚å¹¶ä¸ç®—æ³•å·¥ç¨‹å¸ˆæ·±åº¦åä½œï¼Ÿæœ¬æ–‡åˆ†äº«äº†æˆ‘ä»æ–‡ç§‘ç”Ÿè½¬å‹AIäº§å“ç»ç†çš„ç»éªŒå’Œæ–¹æ³•ã€‚

## æˆ‘çš„è½¬å‹ä¹‹è·¯

ä»åä¸œå¸ˆèŒƒå¤§å­¦æ–°é—»å­¦ä¸“ä¸šæ¯•ä¸šï¼Œåˆ°æˆä¸ºAIäº§å“ç»ç†ï¼Œè¿™ä¸ªè½¬å˜å¹¶ä¸å®¹æ˜“ã€‚ä½†æˆ‘å‘ç°ï¼Œ**æ–‡ç§‘èƒŒæ™¯åè€Œæ˜¯ä¸€ç§ä¼˜åŠ¿**ã€‚

==æ–‡ç§‘è®­ç»ƒè®©æˆ‘æ›´å…³æ³¨ç”¨æˆ·éœ€æ±‚å’Œäº§å“ä½“éªŒï¼Œè€Œä¸æ˜¯è¢«æŠ€æœ¯ç»†èŠ‚æŸç¼šã€‚==

## æ ¸å¿ƒèƒ½åŠ›å»ºè®¾

### 1. æ„å»ºäº§å“çŸ¥è¯†ä½“ç³»

**æŠ€æœ¯ç†è§£**ï¼š
- å­¦ä¹ AIåŸºç¡€æ¦‚å¿µï¼ˆä¸éœ€è¦æ·±å…¥ç®—æ³•ï¼‰
- äº†è§£æ¨¡å‹èƒ½åŠ›è¾¹ç•Œ
- æŒæ¡å¸¸ç”¨æŠ€æœ¯æœ¯è¯­

**äº§å“æ€ç»´**ï¼š
- ç”¨æˆ·åœºæ™¯åˆ†æ
- éœ€æ±‚ä¼˜å…ˆçº§åˆ¤æ–­
- å•†ä¸šä»·å€¼è¯„ä¼°

## æ€»ç»“

==è®°ä½ï¼šæœ€å¥½çš„AIäº§å“ä¸æ˜¯æŠ€æœ¯æœ€å…ˆè¿›çš„ï¼Œè€Œæ˜¯æœ€èƒ½è§£å†³ç”¨æˆ·é—®é¢˜çš„ã€‚==`,
                tags: 'äº§å“ç»ç†,å›¢é˜Ÿåä½œ,èŒä¸šå‘å±•',
                coverImage: 'https://images.unsplash.com/photo-1519389950473-47ba0277781c?w=800&h=400&fit=crop',
                date: '2024-03-10T09:15:00.000Z',
                lastModified: '2024-03-10T09:15:00.000Z'
            }
        ];
        localStorage.setItem('blog_articles', JSON.stringify(articles));
    }

    // åˆå§‹åŒ–
    document.addEventListener('DOMContentLoaded', function() {
        loadArticles();
        setupMarkdownPreview();
        updateBackButton('list'); // åˆå§‹çŠ¶æ€ä¸ºåšå®¢åˆ—è¡¨é¡µ
    });

    // é¡µé¢åˆ‡æ¢å‡½æ•°
    function showBlogList() {
        document.getElementById('blog-list').style.display = 'block';
        document.getElementById('article-view').style.display = 'none';
        document.getElementById('article-editor').style.display = 'none';
        currentEditingId = null;
        clearEditor();
        updateBackButton('list');
    }

    function showEditor(articleId = null) {
        document.getElementById('blog-list').style.display = 'none';
        document.getElementById('article-view').style.display = 'none';
        document.getElementById('article-editor').style.display = 'block';
        
        if (articleId) {
            currentEditingId = articleId;
            loadArticleForEdit(articleId);
        } else {
            currentEditingId = null;
            clearEditor();
        }
        updateBackButton('editor');
    }

    function showArticle(articleId) {
        const article = articles.find(a => a.id === articleId);
        if (!article) return;

        // è®¾ç½®å½“å‰æ–‡ç« IDç”¨äºå¯¼èˆª
        window.currentArticleId = articleId;

        document.getElementById('blog-list').style.display = 'none';
        document.getElementById('article-view').style.display = 'block';
        document.getElementById('article-editor').style.display = 'none';

        const contentDisplay = document.getElementById('article-content-display');
        contentDisplay.innerHTML = `
            <header class="mb-8 text-center">
                <h1 class="text-4xl md:text-5xl font-bold mb-4">${article.title}</h1>
                <div class="flex justify-center items-center gap-4 text-gray-600 dark:text-gray-400 mb-4">
                    <span><i class="far fa-calendar mr-2"></i>${new Date(article.date).toLocaleDateString('zh-CN')}</span>
                    <span><i class="fas fa-user mr-2"></i>æ¿ç –</span>
                </div>
                ${article.tags ? `<div class="mb-6">${article.tags.split(',').map(tag => `<span class="tag">${tag.trim()}</span>`).join('')}</div>` : ''}
                ${article.coverImage ? `<img src="${article.coverImage}" alt="å°é¢å›¾ç‰‡" class="w-full max-w-2xl mx-auto rounded-lg shadow-lg mb-8">` : ''}
            </header>
            <div class="prose">${parseMarkdownWithHighlights(article.content)}</div>
        `;

        // æ›´æ–°å¯¼èˆªæŒ‰é’®
        updateNavigationButtons(articleId);
        updateBackButton('article');
    }

    // æ›´æ–°å¯¼èˆªæŒ‰é’®
    function updateNavigationButtons(currentArticleId) {
        const sortedArticles = [...articles].sort((a, b) => new Date(b.date) - new Date(a.date));
        const currentIndex = sortedArticles.findIndex(a => a.id === currentArticleId);
        
        const prevButton = document.getElementById('prev-article');
        const nextButton = document.getElementById('next-article');
        
        // æ›´æ–°PreviousæŒ‰é’®
        if (currentIndex > 0) {
            const prevArticle = sortedArticles[currentIndex - 1];
            prevButton.style.display = 'flex';
            prevButton.querySelector('.nav-title').textContent = prevArticle.title;
            prevButton.onclick = () => showArticle(prevArticle.id);
        } else {
            prevButton.style.display = 'none';
        }
        
        // æ›´æ–°NextæŒ‰é’®
        if (currentIndex < sortedArticles.length - 1) {
            const nextArticle = sortedArticles[currentIndex + 1];
            nextButton.style.display = 'flex';
            nextButton.querySelector('.nav-title').textContent = nextArticle.title;
            nextButton.onclick = () => showArticle(nextArticle.id);
        } else {
            nextButton.style.display = 'none';
        }
    }

    // åŠ è½½æ–‡ç« åˆ—è¡¨
    function loadArticles() {
        const grid = document.getElementById('articles-grid');
        grid.innerHTML = '';

        if (articles.length === 0) {
            grid.innerHTML = `
                <div class="col-span-full text-center py-12">
                    <i class="fas fa-pen-fancy text-6xl text-gray-300 mb-4"></i>
                    <h3 class="text-xl font-semibold text-gray-600 mb-2">è¿˜æ²¡æœ‰æ–‡ç« </h3>
                    <p class="text-gray-500">ç‚¹å‡»å³ä¸‹è§’çš„ + æŒ‰é’®å¼€å§‹å†™ä½œå§ï¼</p>
                </div>
            `;
            return;
        }

        articles.sort((a, b) => new Date(b.date) - new Date(a.date));

        articles.forEach(article => {
            const articleCard = document.createElement('div');
            articleCard.className = 'article-card cursor-pointer';
            
            const coverImage = article.coverImage || getDefaultCoverImage();
            const excerpt = getExcerpt(article.content);

            articleCard.innerHTML = `
                <div class="card-actions">
                    <button class="card-action-btn edit-btn" onclick="event.stopPropagation(); showEditor('${article.id}')" title="ç¼–è¾‘æ–‡ç« ">
                        <i class="fas fa-edit"></i>
                    </button>
                    <button class="card-action-btn delete-btn" onclick="event.stopPropagation(); deleteArticle('${article.id}')" title="åˆ é™¤æ–‡ç« ">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
                <div class="aspect-w-16 aspect-h-9 mb-4" onclick="showArticle('${article.id}')">
                    <img src="${coverImage}" alt="${article.title}" class="w-full h-48 object-cover">
                </div>
                <div class="p-6" onclick="showArticle('${article.id}')">
                    <h3 class="text-xl font-bold mb-2 line-clamp-2">${article.title}</h3>
                    <p class="text-gray-600 dark:text-gray-400 mb-4 line-clamp-3">${excerpt}</p>
                    <div class="flex justify-between items-center text-sm text-gray-500">
                        <span>${new Date(article.date).toLocaleDateString('zh-CN')}</span>
                        ${article.tags ? `<div>${article.tags.split(',').slice(0, 2).map(tag => `<span class="tag">${tag.trim()}</span>`).join('')}</div>` : ''}
                    </div>
                </div>
            `;

            grid.appendChild(articleCard);
        });
    }

    // è·å–é»˜è®¤å°é¢å›¾ç‰‡
    function getDefaultCoverImage() {
        const defaultImages = [
            'https://images.unsplash.com/photo-1677442136019-21780ecad995?w=800&h=400&fit=crop',
            'https://images.unsplash.com/photo-1620712943543-bcc4688e7485?w=800&h=400&fit=crop',
            'https://images.unsplash.com/photo-1591696331111-ef9586a5b17a?w=800&h=400&fit=crop'
        ];
        return defaultImages[Math.floor(Math.random() * defaultImages.length)];
    }

    // è·å–æ–‡ç« æ‘˜è¦
    function getExcerpt(content) {
        const text = content.replace(/[#*`>\-\[\]]/g, '').trim();
        return text.length > 150 ? text.substring(0, 150) + '...' : text;
    }

    // Markdownç¼–è¾‘å™¨åŠŸèƒ½
    function setupMarkdownPreview() {
        const editor = document.getElementById('markdown-editor');
        const preview = document.getElementById('preview');

        if (editor && preview) {
            editor.addEventListener('input', function() {
                preview.innerHTML = parseMarkdownWithHighlights(this.value);
            });

            // æ·»åŠ Tabé”®æ”¯æŒ
            editor.addEventListener('keydown', function(e) {
                if (e.key === 'Tab') {
                    e.preventDefault();
                    
                    const start = this.selectionStart;
                    const end = this.selectionEnd;
                    
                    if (e.shiftKey) {
                        // Shift+Tab: å‡å°‘ç¼©è¿›
                        const lines = this.value.split('\n');
                        const startLine = this.value.substring(0, start).split('\n').length - 1;
                        const endLine = this.value.substring(0, end).split('\n').length - 1;
                        
                        let newValue = '';
                        let offsetStart = 0;
                        let offsetEnd = 0;
                        
                        for (let i = 0; i < lines.length; i++) {
                            if (i >= startLine && i <= endLine) {
                                if (lines[i].startsWith('    ')) {
                                    lines[i] = lines[i].substring(4);
                                    if (i === startLine) offsetStart -= 4;
                                    if (i === endLine) offsetEnd -= 4;
                                } else if (lines[i].startsWith('\t')) {
                                    lines[i] = lines[i].substring(1);
                                    if (i === startLine) offsetStart -= 1;
                                    if (i === endLine) offsetEnd -= 1;
                                }
                            }
                        }
                        
                        this.value = lines.join('\n');
                        this.setSelectionRange(start + offsetStart, end + offsetEnd);
                    } else {
                        // Tab: å¢åŠ ç¼©è¿›
                        if (start === end) {
                            // æ²¡æœ‰é€‰ä¸­æ–‡æœ¬ï¼Œæ’å…¥Tab
                            this.value = this.value.substring(0, start) + '    ' + this.value.substring(end);
                            this.setSelectionRange(start + 4, start + 4);
                        } else {
                            // æœ‰é€‰ä¸­æ–‡æœ¬ï¼Œå¯¹æ¯è¡Œæ·»åŠ ç¼©è¿›
                            const lines = this.value.split('\n');
                            const startLine = this.value.substring(0, start).split('\n').length - 1;
                            const endLine = this.value.substring(0, end).split('\n').length - 1;
                            
                            for (let i = startLine; i <= endLine; i++) {
                                lines[i] = '    ' + lines[i];
                            }
                            
                            this.value = lines.join('\n');
                            this.setSelectionRange(start + 4, end + 4 * (endLine - startLine + 1));
                        }
                    }
                    
                    // æ›´æ–°é¢„è§ˆ
                    preview.innerHTML = parseMarkdownWithHighlights(this.value);
                }
                
                // Enteré”®è‡ªåŠ¨ç¼©è¿›
                if (e.key === 'Enter') {
                    const start = this.selectionStart;
                    const currentLine = this.value.substring(0, start).split('\n').pop();
                    const indent = currentLine.match(/^(\s*)/)[1];
                    
                    // å¦‚æœå½“å‰è¡Œæ˜¯åˆ—è¡¨é¡¹ï¼Œè‡ªåŠ¨æ·»åŠ åˆ—è¡¨æ ‡è®°
                    const listMatch = currentLine.match(/^(\s*)([-*+]|\d+\.)\s/);
                    if (listMatch) {
                        e.preventDefault();
                        const listMarker = listMatch[2];
                        let newMarker = listMarker;
                        
                        // å¦‚æœæ˜¯æ•°å­—åˆ—è¡¨ï¼Œé€’å¢æ•°å­—
                        if (/\d+\./.test(listMarker)) {
                            const num = parseInt(listMarker) + 1;
                            newMarker = num + '.';
                        }
                        
                        const insertion = '\n' + indent + newMarker + ' ';
                        this.value = this.value.substring(0, start) + insertion + this.value.substring(start);
                        this.setSelectionRange(start + insertion.length, start + insertion.length);
                        
                        // æ›´æ–°é¢„è§ˆ
                        preview.innerHTML = parseMarkdownWithHighlights(this.value);
                    } else if (indent) {
                        // ä¿æŒå½“å‰ç¼©è¿›
                        setTimeout(() => {
                            const newStart = this.selectionStart;
                            this.value = this.value.substring(0, newStart) + indent + this.value.substring(newStart);
                            this.setSelectionRange(newStart + indent.length, newStart + indent.length);
                            
                            // æ›´æ–°é¢„è§ˆ
                            preview.innerHTML = parseMarkdownWithHighlights(this.value);
                        }, 0);
                    }
                }
            });
        }
    }

    // è§£æMarkdownå¹¶å¤„ç†é«˜äº®
    function parseMarkdownWithHighlights(content) {
        // å…ˆå¤„ç†é«˜äº®è¯­æ³• ==text==ï¼Œåœ¨Markdownè§£æä¹‹å‰
        content = content.replace(/==(.*?)==/g, '{{HIGHLIGHT_START}}$1{{HIGHLIGHT_END}}');
        
        // å¤„ç†å›¾ç‰‡å¼•ç”¨ï¼Œå°†ç®€æ´å¼•ç”¨è½¬æ¢ä¸ºå®é™…URL
        content = content.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, function(match, alt, src) {
            // å¦‚æœæ˜¯ç®€æ´çš„å›¾ç‰‡å¼•ç”¨ï¼ˆä¸æ˜¯å®Œæ•´URLï¼‰ï¼Œä»localStorageè·å–å®é™…æ•°æ®
            if (!src.startsWith('http') && !src.startsWith('data:')) {
                const images = JSON.parse(localStorage.getItem('blog_images') || '{}');
                if (images[src]) {
                    return `![${alt}](${images[src]})`;
                }
            }
            return match;
        });
        
        // å¤„ç†è§†é¢‘å¼•ç”¨ï¼Œå°†ç®€æ´å¼•ç”¨è½¬æ¢ä¸ºå®é™…URL
        content = content.replace(/<video([^>]*)>\s*<source\s+src="([^"]+)"([^>]*)>\s*([^<]*)\s*<\/video>/g, function(match, videoAttrs, src, sourceAttrs, fallbackText) {
            // å¦‚æœæ˜¯ç®€æ´çš„è§†é¢‘å¼•ç”¨ï¼Œä»localStorageè·å–å®é™…æ•°æ®
            if (!src.startsWith('http') && !src.startsWith('data:')) {
                const videos = JSON.parse(localStorage.getItem('blog_videos') || '{}');
                if (videos[src]) {
                    return `<video${videoAttrs} style="max-width: 100%; height: auto;"><source src="${videos[src]}"${sourceAttrs}>${fallbackText}</video>`;
                }
            }
            return `<video${videoAttrs} style="max-width: 100%; height: auto;"><source src="${src}"${sourceAttrs}>${fallbackText}</video>`;
        });
        
        // ä½¿ç”¨marked.jsè§£æMarkdown
        let html = marked.parse(content);
        
        // æœ€åå°†å ä½ç¬¦æ›¿æ¢ä¸ºé«˜äº®HTML
        html = html.replace(/\{\{HIGHLIGHT_START\}\}(.*?)\{\{HIGHLIGHT_END\}\}/g, '<div class="highlight">$1</div>');
        
        return html;
    }

    // æ’å…¥Markdownè¯­æ³•
    function insertMarkdown(before, after) {
        const editor = document.getElementById('markdown-editor');
        const start = editor.selectionStart;
        const end = editor.selectionEnd;
        const selectedText = editor.value.substring(start, end);
        const replacement = before + selectedText + after;
        
        editor.value = editor.value.substring(0, start) + replacement + editor.value.substring(end);
        editor.focus();
        editor.setSelectionRange(start + before.length, start + before.length + selectedText.length);
        
        // æ›´æ–°é¢„è§ˆ
        document.getElementById('preview').innerHTML = parseMarkdownWithHighlights(editor.value);
    }

    // æ’å…¥é«˜äº®
    function insertHighlight() {
        insertMarkdown('==', '==');
    }

    // æ’å…¥ä»£ç å—
    function insertCodeBlock() {
        const editor = document.getElementById('markdown-editor');
        const selectedText = editor.value.substring(editor.selectionStart, editor.selectionEnd);
        const codeBlock = `\n\`\`\`\n${selectedText}\n\`\`\`\n`;
        insertAtCursor(editor, codeBlock);
        
        // æ›´æ–°é¢„è§ˆ
        document.getElementById('preview').innerHTML = parseMarkdownWithHighlights(editor.value);
    }

    // å¤„ç†å›¾ç‰‡ä¸Šä¼ 
    function handleImageUpload(event) {
        const file = event.target.files[0];
        if (!file) return;

        const reader = new FileReader();
        reader.onload = function(e) {
            const imageData = e.target.result;
            const imageName = `img_${Date.now()}_${file.name.replace(/\s+/g, '_')}`;
            
            // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
            saveToLocalStorage('blog_images', imageName, imageData);
            
            // æ’å…¥ç®€æ´çš„Markdownå›¾ç‰‡è¯­æ³•
            const editor = document.getElementById('markdown-editor');
            const imageMarkdown = `\n![${file.name}](${imageName})\n`;
            insertAtCursor(editor, imageMarkdown);
            
            // æ›´æ–°é¢„è§ˆ
            document.getElementById('preview').innerHTML = parseMarkdownWithHighlights(editor.value);
        };
        reader.readAsDataURL(file);
    }

    // å¤„ç†è§†é¢‘ä¸Šä¼ 
    function handleVideoUpload(event) {
        const file = event.target.files[0];
        if (!file) return;

        const reader = new FileReader();
        reader.onload = function(e) {
            const videoData = e.target.result;
            const videoName = `video_${Date.now()}_${file.name.replace(/\s+/g, '_')}`;
            
            // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
            saveToLocalStorage('blog_videos', videoName, videoData);
            
            // æ’å…¥ç®€æ´çš„HTMLè§†é¢‘æ ‡ç­¾
            const editor = document.getElementById('markdown-editor');
            const videoHtml = `\n<video controls>\n  <source src="${videoName}" type="${file.type}">\n  æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè§†é¢‘æ’­æ”¾ã€‚\n</video>\n`;
            insertAtCursor(editor, videoHtml);
            
            // æ›´æ–°é¢„è§ˆ
            document.getElementById('preview').innerHTML = parseMarkdownWithHighlights(editor.value);
        };
        reader.readAsDataURL(file);
    }

    // åœ¨å…‰æ ‡ä½ç½®æ’å…¥æ–‡æœ¬
    function insertAtCursor(textarea, text) {
        const start = textarea.selectionStart;
        const end = textarea.selectionEnd;
        textarea.value = textarea.value.substring(0, start) + text + textarea.value.substring(end);
        textarea.focus();
        textarea.setSelectionRange(start + text.length, start + text.length);
    }

    // ä¿å­˜åˆ°localStorageï¼ˆæ¨¡æ‹Ÿæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼‰
    function saveToLocalStorage(key, filename, data) {
        const storage = JSON.parse(localStorage.getItem(key) || '{}');
        storage[filename] = data;
        localStorage.setItem(key, JSON.stringify(storage));
    }

    // ä¿å­˜æ–‡ç« 
    function saveArticle() {
        const title = document.getElementById('article-title').value.trim();
        const content = document.getElementById('markdown-editor').value.trim();
        const tags = document.getElementById('article-tags').value.trim();
        const coverImageFile = document.getElementById('cover-image').files[0];

        if (!title || !content) {
            alert('è¯·å¡«å†™æ ‡é¢˜å’Œå†…å®¹');
            return;
        }

        let coverImage = '';
        if (coverImageFile) {
            const reader = new FileReader();
            reader.onload = function(e) {
                coverImage = e.target.result;
                saveArticleData(title, content, tags, coverImage);
            };
            reader.readAsDataURL(coverImageFile);
        } else {
            saveArticleData(title, content, tags, coverImage);
        }
    }

    function saveArticleData(title, content, tags, coverImage) {
        const article = {
            id: currentEditingId || generateId(),
            title,
            content,
            tags,
            coverImage: coverImage || getDefaultCoverImage(),
            date: currentEditingId ? articles.find(a => a.id === currentEditingId).date : new Date().toISOString(),
            lastModified: new Date().toISOString()
        };

        if (currentEditingId) {
            const index = articles.findIndex(a => a.id === currentEditingId);
            articles[index] = article;
        } else {
            articles.push(article);
        }

        // ä¿å­˜åˆ°localStorageï¼ˆæ¨¡æ‹Ÿä¿å­˜åˆ°blog_content/markdown/ï¼‰
        localStorage.setItem('blog_articles', JSON.stringify(articles));
        saveToLocalStorage('blog_markdown', `${article.id}.md`, content);

        // å®é™…ä¿å­˜æ–‡ä»¶åˆ°æœ¬åœ°æ–‡ä»¶å¤¹
        saveToActualFile(article);

        alert('æ–‡ç« ä¿å­˜æˆåŠŸï¼');
        showBlogList();
        loadArticles();
    }

    // ä¿å­˜æ–‡ä»¶åˆ°å®é™…æ–‡ä»¶å¤¹
    async function saveToActualFile(article) {
        try {
            // åˆ›å»ºMarkdownæ–‡ä»¶å†…å®¹
            const markdownContent = `---
title: ${article.title}
date: ${article.date}
lastModified: ${article.lastModified}
tags: ${article.tags}
coverImage: ${article.coverImage}
---

${article.content}`;

            // åˆ›å»ºæ–‡ä»¶ä¸‹è½½
            const blob = new Blob([markdownContent], { type: 'text/markdown' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${article.id}.md`;
            
            // æç¤ºç”¨æˆ·ä¿å­˜åˆ°blog_content/markdown/æ–‡ä»¶å¤¹
            const message = `ğŸ“ æ–‡ç« å·²å‡†å¤‡å¥½ä¿å­˜ï¼

ğŸ“ è¯·å°†ä¸‹è½½çš„æ–‡ä»¶ä¿å­˜åˆ°ï¼š
   blog_content/markdown/${article.id}.md

ğŸ’¡ æç¤ºï¼š
   â€¢ æ–‡ä»¶åŒ…å«å®Œæ•´çš„æ–‡ç« å†…å®¹å’Œå…ƒæ•°æ®
   â€¢ ä¿å­˜åå¯ä»¥åœ¨å¯¹åº”æ–‡ä»¶å¤¹ä¸­æ‰¾åˆ°
   â€¢ æ”¯æŒé‡æ–°ç¼–è¾‘å’Œå‘å¸ƒ

ç‚¹å‡»ç¡®å®šå¼€å§‹ä¸‹è½½æ–‡ä»¶ã€‚`;

            if (confirm(message)) {
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                // æ˜¾ç¤ºæˆåŠŸæç¤º
                setTimeout(() => {
                    alert('âœ… æ–‡ä»¶ä¸‹è½½æˆåŠŸï¼è¯·å°†æ–‡ä»¶ä¿å­˜åˆ° blog_content/markdown/ æ–‡ä»¶å¤¹ä¸­ã€‚');
                }, 500);
            }
        } catch (error) {
            console.error('ä¿å­˜æ–‡ä»¶æ—¶å‡ºé”™:', error);
            alert('âŒ ä¿å­˜æ–‡ä»¶æ—¶å‡ºé”™ï¼Œè¯·é‡è¯•ã€‚');
        }
    }

    // åŠ è½½æ–‡ç« è¿›è¡Œç¼–è¾‘
    function loadArticleForEdit(articleId) {
        const article = articles.find(a => a.id === articleId);
        if (!article) return;

        document.getElementById('article-title').value = article.title;
        document.getElementById('markdown-editor').value = article.content;
        document.getElementById('article-tags').value = article.tags || '';
        document.getElementById('preview').innerHTML = parseMarkdownWithHighlights(article.content);
    }

    // æ¸…ç©ºç¼–è¾‘å™¨
    function clearEditor() {
        document.getElementById('article-title').value = '';
        document.getElementById('markdown-editor').value = '';
        document.getElementById('article-tags').value = '';
        document.getElementById('cover-image').value = '';
        document.getElementById('preview').innerHTML = '';
    }

    // åˆ é™¤æ–‡ç« 
    function deleteArticle(articleId) {
        if (!confirm('ç¡®å®šè¦åˆ é™¤è¿™ç¯‡æ–‡ç« å—ï¼Ÿ')) return;

        articles = articles.filter(a => a.id !== articleId);
        localStorage.setItem('blog_articles', JSON.stringify(articles));

        // åˆ é™¤å¯¹åº”çš„markdownæ–‡ä»¶
        const markdownStorage = JSON.parse(localStorage.getItem('blog_markdown') || '{}');
        delete markdownStorage[`${articleId}.md`];
        localStorage.setItem('blog_markdown', JSON.stringify(markdownStorage));

        alert('æ–‡ç« å·²åˆ é™¤');
        showBlogList();
        loadArticles();
    }

    // ç”Ÿæˆå”¯ä¸€ID
    function generateId() {
        return Date.now().toString(36) + Math.random().toString(36).substr(2);
    }

    // é”®ç›˜å¿«æ·é”®
    document.addEventListener('keydown', function(e) {
        if (e.ctrlKey || e.metaKey) {
            switch(e.key) {
                case 's':
                    e.preventDefault();
                    if (document.getElementById('article-editor').style.display !== 'none') {
                        saveArticle();
                    }
                    break;
                case 'b':
                    e.preventDefault();
                    if (document.getElementById('article-editor').style.display !== 'none') {
                        insertMarkdown('**', '**');
                    }
                    break;
                case 'i':
                    e.preventDefault();
                    if (document.getElementById('article-editor').style.display !== 'none') {
                        insertMarkdown('*', '*');
                    }
                    break;
            }
        }
    });

    // æ˜¾ç¤ºå›¾ç‰‡åº“
    function showImageGallery() {
        const images = JSON.parse(localStorage.getItem('blog_images') || '{}');
        const imageKeys = Object.keys(images);
        
        if (imageKeys.length === 0) {
            alert('è¿˜æ²¡æœ‰ä¸Šä¼ ä»»ä½•å›¾ç‰‡');
            return;
        }
        
        // åˆ›å»ºå›¾ç‰‡åº“å¼¹çª—
        const modal = document.createElement('div');
        modal.style.cssText = `
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
        `;
        
        const gallery = document.createElement('div');
        gallery.style.cssText = `
            background: white;
            border-radius: 12px;
            padding: 2rem;
            max-width: 80%;
            max-height: 80%;
            overflow-y: auto;
        `;
        
        gallery.innerHTML = `
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                <h3 style="margin: 0; font-size: 1.5rem;">å›¾ç‰‡åº“</h3>
                <button onclick="this.closest('.modal').remove()" style="background: none; border: none; font-size: 1.5rem; cursor: pointer;">&times;</button>
            </div>
            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 1rem;">
                ${imageKeys.map(key => `
                    <div style="border: 1px solid #ddd; border-radius: 8px; overflow: hidden; cursor: pointer;" onclick="insertImageFromGallery('${key}')">
                        <img src="${images[key]}" style="width: 100%; height: 120px; object-fit: cover;">
                        <div style="padding: 0.5rem; font-size: 0.8rem; text-align: center; background: #f5f5f5;">
                            ${key.replace(/^img_\d+_/, '')}
                        </div>
                    </div>
                `).join('')}
            </div>
            <div style="margin-top: 1rem; text-align: center; color: #666; font-size: 0.9rem;">
                ç‚¹å‡»å›¾ç‰‡æ’å…¥åˆ°ç¼–è¾‘å™¨ä¸­
            </div>
        `;
        
        modal.className = 'modal';
        modal.appendChild(gallery);
        document.body.appendChild(modal);
        
        // ç‚¹å‡»èƒŒæ™¯å…³é—­
        modal.addEventListener('click', function(e) {
            if (e.target === modal) {
                modal.remove();
            }
        });
    }
    
    // ä»å›¾ç‰‡åº“æ’å…¥å›¾ç‰‡
    function insertImageFromGallery(imageName) {
        const editor = document.getElementById('markdown-editor');
        const displayName = imageName.replace(/^img_\d+_/, '');
        const imageMarkdown = `\n![${displayName}](${imageName})\n`;
        insertAtCursor(editor, imageMarkdown);
        
        // æ›´æ–°é¢„è§ˆ
        document.getElementById('preview').innerHTML = parseMarkdownWithHighlights(editor.value);
        
        // å…³é—­å›¾ç‰‡åº“
        document.querySelector('.modal').remove();
    }

    // æ›´æ–°è¿”å›æŒ‰é’®
    function updateBackButton(currentPage) {
        const backButton = document.getElementById('back-button');
        const backText = document.getElementById('back-text');
        
        switch(currentPage) {
            case 'list':
                backButton.href = 'index.html';
                backText.textContent = 'è¿”å›ä¸»é¡µ';
                backButton.onclick = null;
                break;
            case 'article':
            case 'editor':
                backButton.href = '#';
                backText.textContent = 'è¿”å›åšå®¢';
                backButton.onclick = function(e) {
                    e.preventDefault();
                    showBlogList();
                };
                break;
        }
    }

    // æ˜¾ç¤ºæ ‡é¢˜èœå•
    function showHeadingMenu() {
        // ç§»é™¤å·²å­˜åœ¨çš„èœå•
        const existingMenu = document.querySelector('.heading-menu');
        if (existingMenu) {
            existingMenu.remove();
            return;
        }

        const menu = document.createElement('div');
        menu.className = 'heading-menu';
        menu.style.cssText = `
            position: absolute;
            top: 100%;
            left: 0;
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            min-width: 150px;
        `;

        const headings = [
            { level: 1, text: '# æ ‡é¢˜ 1', prefix: '# ' },
            { level: 2, text: '## æ ‡é¢˜ 2', prefix: '## ' },
            { level: 3, text: '### æ ‡é¢˜ 3', prefix: '### ' },
            { level: 4, text: '#### æ ‡é¢˜ 4', prefix: '#### ' },
            { level: 5, text: '##### æ ‡é¢˜ 5', prefix: '##### ' },
            { level: 6, text: '###### æ ‡é¢˜ 6', prefix: '###### ' }
        ];

        headings.forEach(heading => {
            const item = document.createElement('div');
            item.style.cssText = `
                padding: 0.5rem 1rem;
                cursor: pointer;
                border-bottom: 1px solid #f3f4f6;
                font-size: ${2 - heading.level * 0.1}rem;
                font-weight: ${700 - heading.level * 50};
            `;
            item.textContent = heading.text;
            item.onclick = () => {
                insertMarkdown(heading.prefix, '');
                menu.remove();
            };
            item.onmouseover = () => {
                item.style.backgroundColor = '#f3f4f6';
            };
            item.onmouseout = () => {
                item.style.backgroundColor = 'white';
            };
            menu.appendChild(item);
        });

        // æ‰¾åˆ°æ ‡é¢˜æŒ‰é’®å¹¶æ·»åŠ èœå•
        const headingBtn = document.querySelector('.heading-menu-btn');
        headingBtn.style.position = 'relative';
        headingBtn.appendChild(menu);

        // ç‚¹å‡»å…¶ä»–åœ°æ–¹å…³é—­èœå•
        setTimeout(() => {
            document.addEventListener('click', function closeMenu(e) {
                if (!headingBtn.contains(e.target)) {
                    menu.remove();
                    document.removeEventListener('click', closeMenu);
                }
            });
        }, 100);
    }
</script>
</body>
</html> 